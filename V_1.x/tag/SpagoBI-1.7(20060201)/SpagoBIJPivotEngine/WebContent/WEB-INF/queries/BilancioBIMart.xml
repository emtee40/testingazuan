<?xml version="1.0"?>
<Schema name="bilancioBI">

<!-- Shared dimensions -->
    <Dimension name="Anno">
		<Hierarchy hasAll="true" allMemberName="Tutti">
			<Level name="Anno" column="anno" uniqueMembers="true"/>
		</Hierarchy>
	</Dimension>
	
	<Dimension name="Bilancio per FO/UPB">
		<Hierarchy hasAll="true" allMemberName="Tutti" primaryKey="capitolo">
			<Table name="anagrafica_pluriennale_uscite"/>
			<Level name="Funzione Obiettivo" column="funzione_obiettivo" uniqueMembers="true"/>
			<Level name="UPB" column="upb" uniqueMembers="true"/>
			<Level name="Capitolo" column="capitolo" uniqueMembers="true"/>
		</Hierarchy>
	</Dimension>
	
	<Dimension name="Bilancio per Segr/Dir">
		<Hierarchy hasAll="true" allMemberName="Tutti" primaryKey="capitolo" primaryKeyTable="anagrafica_pluriennale_uscite">
			<Join leftKey="capitolo" rightKey="capitolo">
				<Table name="anagrafica_pluriennale_uscite"/>
				<Table name="anagrafica_capitoli"/>
			</Join>
			<Level name="Segreteria" table="anagrafica_pluriennale_uscite" column="segreteria_budget" uniqueMembers="true">
				<Property name="Nome" column="segreteria_budget_d"/>
			</Level>
			<Level name="Direzione" table="anagrafica_pluriennale_uscite"  column="struttura_budget" uniqueMembers="true">
				<Property name="Nome" column="struttura_budget_d"/>
			</Level>
			<Level name="Capitolo" table="anagrafica_capitoli" column="capitolo" uniqueMembers="true">
				<Property name="Nome" column="descrizione"/>
			</Level>
		</Hierarchy>
	</Dimension>


<!-- Cubes -->

	<Cube name="Bilancio_FO_UPB">
		<Table name="bilancio_uscite"/>
		<DimensionUsage name="Anno" source="Anno" foreignKey="anno"/>
		<DimensionUsage name="Bilancio per FO/UPB" source="Bilancio per FO/UPB" foreignKey="capitolo"/>
		<Measure name="Competenza" column="competenza_iniziale" aggregator="sum" formatString="#,###.00"/>
		<Measure name="Impegni" column="impegni_netti" aggregator="sum" formatString="#,###.00"/>
		<Measure name="Mand C/Comp" column="mandati_competenza_netti" aggregator="sum" formatString="#,###.00"/>
		<Measure name="Res Iniziali" column="residui_iniziali" aggregator="sum" formatString="#,###.00"/>
		<Measure name="Mand C/Residui" column="mandati_residui" aggregator="sum" formatString="#,###.00"/>
		<Measure name="Stock Perenti" column="stock_iniziale_perenti" aggregator="sum" formatString="#,###.00"/>
		<Measure name="Mand Perenti" column="mandati_perenti" aggregator="sum" formatString="#,###.00"/>
	</Cube>

	<Cube name="Bilancio_Segr_Dir">
		<Table name="bilancio_uscite"/>
		<DimensionUsage name="Anno" source="Anno" foreignKey="anno"/>
		<DimensionUsage name="Bilancio per Segr/Dir" source="Bilancio per Segr/Dir" foreignKey="capitolo"/>
		<Measure name="Competenza" column="competenza_iniziale" aggregator="sum" formatString="#,###.00"/>
		<Measure name="Impegni" column="impegni_netti" aggregator="sum" formatString="#,###.00"/>
		<Measure name="Mand C/Comp" column="mandati_competenza_netti" aggregator="sum" formatString="#,###.00"/>
		<Measure name="Res Iniziali" column="residui_iniziali" aggregator="sum" formatString="#,###.00"/>
		<Measure name="Mand C/Residui" column="mandati_residui" aggregator="sum" formatString="#,###.00"/>
		<Measure name="Stock Perenti" column="stock_iniziale_perenti" aggregator="sum" formatString="#,###.00"/>
		<Measure name="Mand Perenti" column="mandati_perenti" aggregator="sum" formatString="#,###.00"/>
    </Cube>

</Schema>