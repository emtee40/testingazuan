<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Frameset//EN" "http://www.w3.org/TR/html4/frameset.dtd">
<html>
<head>
<title>SpagoBI test: external invocation of a document's export</title>

</head>

<p>Below is SpagoBI iframe.</p>
<br/>
	<input type="button" value="Export PDF" onclick="exportDoc('PDF');" > &nbsp;
	<input type="button" value="Export XLS" onclick="exportDoc('XLS');" ><br/>
  <iframe id="frame1" name="my_frame" style="border: 0px" 
    src="http://localhost:8080/SpagoBI"
  	width="1000" height="800" 
  	sandbox="allow-same-origin allow-scripts allow-forms allow-popups" > 
  	<!-- sandbox="allow-same-origin allow-scripts allow-popups allow-forms" -->
  	<!-- src="http://localhost:8080/SpagoBI/servlet/AdapterHTTP?NEW_SESSION=TRUE&ACTION_NAME=EXECUTE_DOCUMENT_ACTION&OBJECT_LABEL=composto&TOOLBAR_VISIBLE=TRUE&SLIDERS_VISIBLE=FALSE&PARAMETERS=" -->
  </iframe>
  
<script>
function exportDoc(outputType){
	var iframe = document.getElementById("frame1");
	var spagobiWindow = iframe.contentWindow;
	spagobiWindow.Sbi.execution.ExporterUtils.exportCurrentDocument(outputType);
};
</script>
</html>
