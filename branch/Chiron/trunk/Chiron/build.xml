<?xml version="1.0"?>

<project name="Chiron" default="buildSource">

	<description>
		Chiron build file
	</description>
	
	<!-- Load all the default properties, and any the user wants    -->
	<!-- to contribute (without having to type -D or edit this file -->
	<property file="${basedir}/build.properties" />
	
	<target name="buildSource" depends="replaceSource"></target>
	
		
	
	
	<target name="replaceSource" depends="createSourceScriptFiles">
		
		<replace file="${js.spagobi.source.dir}/script/chiron.web.js">
	
			<replacefilter 
			    token="../../qooxdoo-0.8" 
			    value="../js/qooxdoo-0.8"/>		  
			
			<replacefilter 
			    token="./class/spagobi" 
			    value="../js/spagobi/source/class/spagobi"/>
			
			<replacefilter 
				token='qxlibraries["spagobi"]={"resourceUri":"../source/resource"};' 
				value='qxlibraries["spagobi"]={"resourceUri":".."};'/>
			
			
			
		
		</replace>
		
	</target>
	
	
		
	<target name="createSourceScriptFiles" depends="makeSource">
			<copy file="${js.spagobi.source.dir}/script/spagobi.js" 
				  tofile="${js.spagobi.source.dir}/script/chiron.web.js"/>
			
			<copy file="${js.spagobi.source.dir}/script/spagobi.js" 
						  tofile="${js.spagobi.source.dir}/script/chiron.portlet.js"/>
			
	</target>
	
	<target name="makeSource" >
		 <exec executable="cmd" dir="${basedir}/WebContent/js/spagobi" >
			<arg value="/c"/>
			<arg value="generate.py source"/>
		 </exec> 
	</target>




	
	
</project>
	